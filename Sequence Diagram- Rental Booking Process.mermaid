sequenceDiagram
    actor Renter
    actor Provider
    participant UI as Web/Mobile UI
    participant API as API Gateway
    participant BS as Booking Service
    participant PS as Payment Service
    participant NS as Notification Service
    participant DB as Database
    
    Renter->>UI: Search for items
    UI->>API: GET /api/items?filters
    API->>DB: Query available items
    DB-->>API: Return matching items
    API-->>UI: Return search results
    UI-->>Renter: Display items
    
    Renter->>UI: Select item and dates
    UI->>API: GET /api/items/{id}
    API->>DB: Get item details
    DB-->>API: Return item data
    API-->>UI: Return item details
    UI-->>Renter: Display item details and availability
    
    Renter->>UI: Confirm booking request
    UI->>API: POST /api/bookings
    API->>BS: Create booking request
    BS->>DB: Save booking (status: pending)
    DB-->>BS: Confirm save
    BS-->>API: Return booking details
    API-->>UI: Return booking confirmation
    UI-->>Renter: Display booking details
    
    BS->>NS: Send notification to provider
    NS->>Provider: Notify about booking request
    
    Provider->>UI: Review booking request
    UI->>API: GET /api/bookings/{id}
    API->>DB: Get booking details
    DB-->>API: Return booking data
    API-->>UI: Return booking details
    UI-->>Provider: Display booking request
    
    Provider->>UI: Accept booking
    UI->>API: PUT /api/bookings/{id}/confirm
    API->>BS: Update booking status
    BS->>DB: Update booking (status: confirmed)
    DB-->>BS: Confirm update
    BS-->>API: Return updated booking
    API-->>UI: Return success
    UI-->>Provider: Display confirmation
    
    BS->>NS: Send confirmation to renter
    NS->>Renter: Notify booking confirmed
    
    Renter->>UI: Process payment
    UI->>API: POST /api/payments
    API->>PS: Process payment
    PS->>DB: Save payment details
    DB-->>PS: Confirm save
    PS-->>API: Return payment confirmation
    API-->>UI: Return success
    UI-->>Renter: Display payment confirmation
    
    PS->>NS: Send payment receipt
    NS->>Renter: Send payment confirmation
    NS->>Provider: Notify of payment
